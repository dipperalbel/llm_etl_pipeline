repos:

  # Commitizen hook for conventional commits
  - repo: https://github.com/commitizen-tools/commitizen
    rev: v4.5.1
    hooks:
      - id: commitizen
        stages: [commit-msg]
  
  # Custom local hooks
  - repo: local
    hooks:

      # Use locally installed Black
      - id: black
        name: Black code formatter
        entry: poetry run black llm_etl_pipeline tests
        pass_filenames: false
        language: system
        files: '\.py$'
        stages: [pre-commit]

      # Use locally installed isort
      - id: isort
        name: Sort imports
        entry: poetry run isort llm_etl_pipeline tests
        pass_filenames: false
        language: system
        files: '\.py$'
        stages: [pre-commit]

      # Poetry check
      - id: poetry
        name: Poetry check
        entry: poetry check --lock
        pass_filenames: false
        language: system
        stages: [pre-commit]
        
      # Export requirements files
      - id: export-requirements
        name: Export requirements files
        entry: python
        args: ["-c", "import subprocess; subprocess.run(['poetry', 'export', '-f', 'requirements.txt', '--output', 'dev/requirements/requirements.main.txt']); subprocess.run(['poetry', 'export', '-f', 'requirements.txt', '--output', 'dev/requirements/requirements.dev.txt', '--with', 'dev'])"]
        language: python
        pass_filenames: false
        always_run: true
        stages: [pre-commit]